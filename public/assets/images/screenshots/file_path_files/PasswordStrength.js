(function(n){n.fn.passStrengthify=function(t){var e=n(this),u,o=[[0,8,16,32,48,64,72],[0,16,32,48,64,78,92],[0,32,64,78,92,108,128]],s=["Very weak","Very weak","Weak","Weak","Moderate","Good","Strong","Very strong"],f=["gray","red","red","#C00000","orange","#0099FF","blue","green"],r=o[0],c=n("<span>").css("margin-left","1em"),h=[],i=0,l=0,a=!1,p=function(n,r,u){var y=h.length,e,o,l,v;for(v=u?t.labels.tooShort:a?Math.round(r*100)/100+" bits":s[n],l=f[n],e=f[n],o=f[0],c.text(v).css("color",l),i=0;i<y;i++)h[i].css("background-color",i<n?e:o)},v=function(n,t){return t.search(n)!=-1},w=function(n,t,i){var u=n.charAt(t),f={"1":"l","3":"e","4":"a","5":"s","7":"t","@":"a",$:"s"},o,e,r,s,h,c;return(typeof f[u]!="undefined"&&(u=f[u]),!u.match(/^[a-zA-Z]$/))?1/i:(o=u.toLowerCase().charCodeAt(0)-"a".charCodeAt(0),r=null,t&&(r=n.charAt(t-1),typeof f[r]!="undefined"&&(r=f[r])),s=r!=null&&r.match(/^[a-zA-Z]$/),s?(h=r.toLowerCase().charCodeAt(0)-"a".charCodeAt(0),e=[.0002835,.0228302,.0369041,.042629,.0012216,.0075739,.0171385,.0014659,.0372661,.0002353,.0110124,.0778259,.0260757,.2145354,.0005459,.0195213,.0001749,.110477,.093429,.131796,.0098029,.0306574,.0088799,.0009562,.0233701,.0018701,.0580027,.0058699,791e-7,.0022625,.3416714,.0002057,.0004272,.0003639,.0479084,.0076894,0,.115056,.0012816,.0003481,.0966553,158e-7,0,.0740301,.0226884,.010743,.1196127,.001155,316e-7,0,.0864502,0,.1229841,271e-7,.0215451,.0005246,.1715916,9e-6,0,.1701716,.056549,0,.0453966,.0488879,0,362e-7,.1759242,9e-6,.0017185,.0376812,.0010492,.0906756,.0358361,0,0,0,.0041969,9e-6,.0280345,.0005057,.0002585,.0081086,.1224833,.0006799,.0054844,.000708,.0794902,.0003484,.0001911,.0092662,.0021466,.0030456,.0397283,.000163,225e-7,.0178918,.0307037,.0009159,.0178805,.0027759,.0013655,0,.0076478,0,.0545873,.0012798,.0224322,.0843434,.0317097,.008564,.0052834,.0017762,.0127186,.0002605,.0010967,.0339975,.0186268,.0815271,.0032334,.0101307,.0021424,.1307517,.0712793,.0241537,.0014289,.0157312,.0070879,.0105139,.0125997,.0001831,.0638579,.0002384,.0003179,.0002086,.0928264,.0500293,199e-7,993e-7,.0820576,0,199e-7,.0266638,397e-7,894e-7,.1545186,.0001689,99e-7,.0825344,.0039539,.034194,.0334986,99e-7,.0001987,0,.00152,0,.0592435,.0003842,.0005205,.0020078,.1482326,.0002727,.0101631,.1420108,.0501091,248e-7,372e-7,.0395122,.002987,.0127906,.0573224,.0005577,0,.0884686,.0261142,.0062466,.0256309,372e-7,.000347,0,.003272,.0001363,.1580232,.0007737,.002046,.0005185,.4597035,.0004627,359e-7,718e-7,.1252667,0,4e-6,.0014278,.0013042,.0012922,.0700557,439e-7,.0003191,.0117178,.0022056,.0297253,.0131497,0,.001029,0,.0072309,0,.0166996,.0069144,.0486793,.0363474,.0480664,.0271435,.0307856,775e-7,.0004826,35e-7,.0073125,.0526842,.0412929,.2618995,.0497818,.0062698,.0004333,.043762,.1157982,.1198384,.000701,.0235788,211e-7,.001881,0,.0032265,.2106638,0,0,0,.190642,0,0,0,.0004353,0,0,0,0,0,.2644178,0,0,0,0,0,.3299238,0,0,0,.0002176,0,.0169234,.0011671,.0005058,.0017118,.3321662,.0041628,.0004669,.0007781,.1300965,0,.0003112,.0185963,.0009726,.100957,.0113601,.001206,0,.0004279,.0613523,.0022954,.0029956,0,.0041239,0,.0086757,0,.10168,.0005515,.0020459,.0668636,.1657445,.0134024,.0011801,.0001542,.1107889,119e-7,.0053728,.135518,.0055389,.0009726,.0826499,.0022654,59e-7,.0018443,.0230153,.0180635,.0144461,.004163,.0025797,0,.0968765,237e-7,.1539307,.0285939,.0001653,.0025384,.2496134,.0017798,195e-7,.0003015,.0877464,195e-7,0,.0015756,.0221846,.0029567,.1098532,.0485124,0,.016991,.0249954,.0008461,.0385435,292e-7,.0001167,0,.0505257,0,.0240107,.0005432,.0423173,.1767352,.0849166,.0053036,.1188694,.0028799,.0295789,.0012223,.0071353,.0087755,.0006582,.0085073,.0653564,.0003343,.0009716,.0004144,.0427003,.0956004,.0093814,.00335,.0008497,.0003343,.012115,.0001288,.0083175,.0072923,.0127087,.0203076,.0029439,.1135873,.0060659,.0018527,.0087857,.0001978,.0106912,.0268647,.0580447,.1459838,.0330625,.0138659,.0002308,.1175433,.032268,.0492657,.1337201,.0164801,.0488371,.0005374,.0033923,.0008571,.1284508,.0004427,.0004427,.0004713,.2213542,.0001428,857e-7,.0221226,.0538854,286e-7,.0001143,.0957597,.0010854,.0005856,.1212242,.0607692,0,.1362487,.0222939,.0408603,.0270926,0,.0011711,0,.0042274,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.0002284,.0002284,0,.9949749,0,0,0,0,0,.0733524,.0032081,.0116789,.028407,.234553,.0056616,.0107385,.0026432,.0792432,435e-7,.0087196,.0117263,.0192448,.0221961,.0919374,.0048043,316e-7,.0189406,.0459213,.0421561,.0173721,.0070603,.0019873,4e-6,.0284504,.0055945,.0349781,.0006441,.0157796,.0015208,.1179849,.0010558,.0004688,.0569819,.0506053,495e-7,.005378,.0114497,.006552,.0022488,.0491264,.0287844,.0008309,.0001906,.0463897,.1269191,.0330152,8e-5,.0053856,0,.0020925,0,.0393295,.000159,.0037195,674e-7,.0892434,.0009218,404e-7,.3352928,.0666758,54e-7,162e-7,.0146273,.000911,.0011051,.0913053,809e-7,27e-7,.0310281,.0245378,.0171177,.0185732,27e-7,.0078702,0,.0121422,.0002776,.0261517,.0181796,.0459729,.0223272,.0308931,.0058765,.0505571,699e-7,.0298191,87e-7,.0001572,.1066327,.0308669,.1156002,.002017,.0448465,.0001746,.1626908,.1207345,.1249869,349e-7,.0009343,.0002008,.0008819,.0002969,.0010042,.1022242,0,0,.0049559,.6796927,0,0,.0002371,.1467561,0,0,.0001423,0,.0128284,.0429195,0,0,.0008299,.0003083,0,.0025847,.0005928,0,0,.0038888,0,.1832539,.0003329,.0002984,.0018938,.1605624,.0013085,344e-7,.1893372,.1788924,0,.000505,.0089412,.0002755,.0372798,.0933831,803e-7,115e-7,.0082066,.0126485,.0018135,.0011707,0,.0003214,0,.0006887,0,.0600144,0,.1573582,.001005,.05542,0,.0001436,.0132089,.1122757,0,0,.0014358,.0001436,0,.0055994,.2157933,.0031587,0,.0027279,.2360373,.0195262,.0051687,.0001436,.0093324,.0020101,0,.0072178,.0039321,.0011985,.0020738,.0562745,.0015217,.0003097,.0007137,.0141393,135e-7,269e-7,.0031914,.0039051,.0022488,.1205478,.0027875,0,.0048882,.0324935,.0109613,.0005925,673e-7,.0016025,.0001347,943e-7,.000202,.4219769,.0007526,.0060211,.0067737,.3038133,0,0,.0005018,.0709985,.0002509,0,.0198194,0,0,.0730055,0,0,.0002509,.0017561,.0005018,.0037632,.0010035,0,0,.0100351,.026844][o+26*h]):(c=t?[.080642499002080981,.015373768624831691,.026892340312538593,.043286671390026357,.12886234260657689,.0244847137116921,.019625534749730816,.060987267963718068,.06905550211598431,.0011176940633901926,.0062521823678781188,.041016761327711163,.025009719347800208,.069849754102356679,.073783151266212627,.017031440203182008,.0010648594165322703,.06156572691936394,.063817324270356,.090246649949305979,.0278568510204016,.010257964235274787,.021192261444145363,.0016941732664605912,.01806326249861108,.0009695838238376564]:[.11617102232902775,.047081205567237411,.035155702413137084,.02673475518173626,.020026033843997197,.0378391909482327,.019525382997897269,.072414138379893869,.062941824371683192,.0063182136777811164,.0069089816761790327,.027085210774006212,.043796936016821872,.023680785020526691,.062721537999399224,.025483128066486435,.00043055972764593971,.016551516972063685,.077650946230099133,.16692700510663863,.014889356163011918,.0061980574747171327,.066696705717432664,50065084609993e-18,.01622108741363773,.00050065084609993],e=c[o]),i>=26&&(e*=26/i),e)},b=function(n){var i=0,f={"[a-z]":26,"[A-Z]":26,"(\\d[^\\d])|(^\\d+$)":10,"[\\W_]":32},r,u,t,e;if(n=n.replace(/(.)(\1)(\1)+/gi,"$1$2"),n=n.replace(/(a)(b(c(d(e(f(g(h(i(j(k(l(m(n(o(p(q(r(u(v(w(x(y(z)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?/gi,"$1"),n=n.replace(/(0)(1(2(3(4(5(6(7(8(9)?)?)?)?)?)?)?)?)?/g,"$1"),n=n.replace(/(1)(2(3(4(5(6(7(8(9(0)?)?)?)?)?)?)?)?)?/g,"$1"),n=n.replace(/([^\d])(\d)(\d)+$/,"$1$2"),!n.length)return 0;for(r in f)v(new RegExp(r),n)&&(i+=f[r]);if(!i)return 0;for(u=0,t=0;t<n.length;t++)e=w(n,t,i),u+=Math.max(-7,Math.log(e)/.69314718055994529);return-1*u},k=function(n){var t=0,u=0;if(u=b(n),r.length&&r[0]instanceof RegExp)jQuery.each(r,function(i,r){t+=v(r,n)});else for(i=0;i<r.length;i++){if(u<r[i])break;t=i+1}return[u,t]},y=function(){var i=n(this).val(),f=!i.length||i.length<l,e,o,r;r=k(i);e=r[0];o=f?0:r[1];t.hideOnEmpty&&!i.length?u.css("visibility","hidden"):u.css("visibility","visible");p(o,e,f)};return typeof t=="undefined"&&(t={}),typeof t.labels=="undefined"&&(t.labels={}),t.labels=n.extend({tooShort:"Too short",passwordStrength:"Password strength:"},t.labels),u=n("<span>").css("display","inline-block").addClass("passStrengthify"),n(this).each(function(){var v;t.element?t.element.append(u):n(this).parent().append(u);t.minimum&&(l=t.minimum);t.maxWidth||(t.maxWidth=125);typeof t.security=="undefined"&&(t.security=1);typeof t.hideOnEmpty=="undefined"&&(t.hideOnEmpty=!0);t.security>=0&&t.security<o.length&&(r=o[t.security]);t.levels||(t.levels=s);t.colours||(t.colours=f);t.tests||(t.tests=r);t.levels&&t.colours&&t.tests&&t.levels.length==t.colours.length&&t.colours.length==t.tests.length+1&&(s=t.levels,f=t.colours,r=t.tests);t.rawEntropy&&(a=!0);u.append(n("<div>").append(n("<span>").css("font-size","smaller").text(t.labels.passwordStrength).append(c)));var w=t.maxWidth*1,p=3,b=Math.round((w-p*r.length)/r.length);for(i=0;i<r.length;i++)v=n("<span>").css("height","3px").css("width",b+"px").css("margin-right",p+"px").css("max-height","3px").css("font-size","1px").css("float","left").css("padding-right","0"),h.push(v),u.append(v);e.keypress(y);e.keyup(y);e.trigger("keyup")})}})(jQuery);